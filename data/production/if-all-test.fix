do array("creator", flushWith: record)
  do entity("", sameEntity:"true")
    if
      do all (flushWith: "metadata.mods.name") 
        contains ("metadata.mods.name.role.roleTerm.value", "aut|cre")
      end
      do choose(flushWith: "metadata.mods.name")
        do map("metadata.mods.name.type", "type")
          equals(string: "personal")
          constant(value:"Person")
        end
        do map("metadata.mods.name.type", "type")
          equals(string: "corporate")
          constant(value:"Organization")
        end
      end  
      do choose(flushWith: "metadata.mods.name")
        do map("metadata.mods.name.valueURI", "name")
          lookup(in: "data/maps/duepub-corporate.tsv")
        end
        do map("metadata.mods.name.displayForm.value", "name")
          replace(pattern: "(.+), (.+)", with: "$2 $1")
        end
      end
    end
  end
end
